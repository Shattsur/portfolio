# Прогнозирование заказов такси на следующий час

## Описание проекта

Проект выполнен для компании «Чётенькое такси» с целью прогнозирования количества заказов такси на следующий час. Это позволит оптимизировать распределение водителей в периоды пиковой нагрузки, улучшая качество обслуживания клиентов и эффективность работы сервиса. Основная задача — достичь значения метрики RMSE не более 48 на тестовой выборке.

**Исходные данные:**
- Данные содержат информацию о заказах такси с марта по август 2018 года.
- Включают временные метки (`datetime`) и количество заказов (`num_orders`).
- Объём данных: 26,496 строк.

**Основные этапы работы:**
1. **Подготовка данных:**
   - Преобразование временных меток в формат `datetime`.
   - Ресемплирование данных по часам.
   - Проверка на пропуски, дубликаты и аномалии.

2. **Анализ данных:**
   - Проверка стационарности временного ряда (тест Дики-Фуллера).
   - Выявление трендов и сезонности (суточные и недельные паттерны).
   - Анализ аномалий и их распределения по дням недели.

3. **Обучение модели:**
   - Создание признаков: лаговые значения, скользящие статистики, циклическое кодирование времени.
   - Оптимизация гиперпараметров модели XGBoost с помощью Optuna.
   - Оценка качества модели на тестовой выборке (метрики R2 и RMSE).

4. **Интерпретация результатов:**
   - Анализ важности признаков.
   - Оценка ошибок прогнозирования по дням недели.

**Используемые библиотеки:**
- `pandas`, `numpy` — обработка данных.
- `matplotlib`, `seaborn`, `plotly` — визуализация.
- `sklearn` — предобработка и пайплайны.
- `statsmodels` — анализ временных рядов.
- `xgboost` — построение модели.
- `optuna` — оптимизация гиперпараметров.
- `mlflow` — логирование экспериментов.

## Ключевые выводы

1. **Результаты моделирования:**
   - Модель достигла целевого значения RMSE (38.3), что ниже требуемого порога (48).
   - Коэффициент детерминации R2 составил 0.577, что указывает на объяснение около 57.7% дисперсии данных.

2. **Закономерности в данных:**
   - Наибольший спрос наблюдается в **понедельник утром** и **пятницу вечером**.
   - Сезонность: пики заказов приходятся на 00:00 и 10:00, минимальная активность — в 6:00.
   - Аномалии не связаны с выходными днями, но требуют дополнительного анализа (например, погодные условия или события).

3. **Проблемы и рекомендации:**
   - **Недроценка спроса:** Добавить признаки, отражающие начало/конец недели.
   - **Запаздывание модели:** Использовать более сложные методы (например, LSTM) для учета резких изменений.
   - **Бизнес-рекомендации:**
     - Увеличить число водителей в часы пик (понедельник 10:00, пятница 22:00).
     - Запускать маркетинговые акции в периоды низкого спроса (например, воскресенье).

## Практическая значимость

Проект успешно решает задачу прогнозирования заказов и предоставляет actionable insights для бизнеса. Дальнейшая работа может быть направлена на интеграцию модели в реальные процессы компании и её дообучение на новых данных. Учет внешних факторов (погода, события) позволит улучшить точность прогнозов.